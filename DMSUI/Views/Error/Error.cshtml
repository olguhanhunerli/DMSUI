@{
    ViewData["Title"] = "Bir Sorun Oluştu";
    var statusCode = ViewBag.StatusCode as int?;
    string traceId = ViewBag.TraceId as string;

    string title = statusCode switch
    {
        401 => "Oturum gerekli",
        403 => "Erişim izniniz yok",
        404 => "Sayfa bulunamadı",
        409 => "İşlem çakışması",
        500 => "Sunucu hatası",
        _ => "Bir hata oluştu"
    };

    string description = statusCode switch
    {
        401 => "Bu işlemi yapmak için giriş yapmanız gerekiyor.",
        403 => "Bu sayfayı görüntülemek için gerekli yetkilere sahip değilsiniz.",
        404 => "Aradığınız sayfa ya kaldırıldı ya da hiç var olmadı.",
        409 => "Bu işlem mevcut durumla çakıştı. Lütfen sayfayı yenileyip tekrar deneyin.",
        500 => "Sunucuda beklenmeyen bir hata oluştu. Lütfen daha sonra tekrar deneyin.",
        _ => "İşlem sırasında beklenmeyen bir hata meydana geldi."
    };

    var errorMessage = ViewBag.ErrorMessage as string;
    var errorDetail = ViewBag.ErrorDetail as string;
}

<div class="container d-flex justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="card shadow-sm border-0" style="max-width: 560px; width: 100%;">
        <div class="card-body text-center p-4">

            <div class="mb-3">
                <span class="display-4 text-warning">⚠️</span>
            </div>

            <h4 class="mb-2">@title</h4>

            <p class="text-muted mb-3">@description</p>

            @if (statusCode != null)
            {
                <div class="badge bg-light text-dark mb-2">
                    HTTP @statusCode
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(traceId))
            {
                <div class="small text-muted mb-3">
                    TraceId: <code>@traceId</code>
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(errorMessage))
            {
                <div class="alert alert-danger small">
                    @errorMessage
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(errorDetail) &&
            Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") == "Development")
            {
                <details class="text-start mt-3">
                    <summary class="text-muted small">Detayları göster</summary>
                    <pre class="small mt-2">@errorDetail</pre>
                </details>
            }

            @if (ViewBag.StackTrace != null &&
            Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") == "Development")
            {
                <details class="text-start mt-3">
                    <summary class="text-muted small">StackTrace</summary>
                    <pre class="small mt-2">@ViewBag.StackTrace</pre>
                </details>
            }

            <div class="d-flex justify-content-center gap-2 mt-4">
                <a asp-controller="Dashboard" asp-action="Index" class="btn btn-primary">Anasayfa</a>

                @if (statusCode == 401 || statusCode == 403)
                {
                    <a asp-controller="Auth" asp-action="Login" class="btn btn-outline-secondary">Giriş Yap</a>
                }
            </div>

        </div>
    </div>
</div>
