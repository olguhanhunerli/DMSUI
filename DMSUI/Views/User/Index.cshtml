@using DMSUI.ViewModels
@model List<UserViewModel>

@{
    ViewData["Title"] = "Kullanıcılar";
}

<div class=" mt-0 pt-0 px-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-semibold mb-0">Kullanıcılar</h5>

        <a asp-controller="User" asp-action="Create"
           class="btn btn-primary btn-sm px-3">
            <i class="bi bi-plus-circle me-1"></i> Yeni Kullanıcı
        </a>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body p-2 table-responsive">

            <table class="table table-hover align-middle mb-0 small w-100">
                <thead class="table-light text-nowrap">
                    <tr>
                        <th class="px-3">#</th>
                        <th class="px-3">Ad Soyad</th>
                        <th class="px-3">Kullanıcı Adı</th>
                        <th class="px-3">Email</th>
                        <th class="px-3">Telefon</th>
                        <th class="px-3">Rol</th>
                        <th class="px-3">Departman</th>
                        <th class="px-3">Şirket</th>
                        <th class="px-3">Pozisyon</th>
                        <th class="px-3">Yönetici</th>
                        <th class="px-3 text-center">Onay</th>
                       
                        <th class="px-3 text-center">Durum</th>
                        <th class="px-3 text-end">İşlemler</th>
                    </tr>
                </thead>

                <tbody class="text-nowrap">

                    @foreach (var user in Model)
                    {
                        <tr>
                            <td class="px-3">@user.Id</td>

                            <td class="fw-semibold px-3">
                                @user.FirstName @user.LastName
                            </td>

                            <td class="px-3">@user.UserName</td>

                            <td class="px-3">@user.Email</td>

                            <td class="px-3">@user.PhoneNumber</td>

                            <td class="px-3">
                                <span class="badge bg-secondary px-2 py-1">
                                    @user.RoleName
                                </span>
                            </td>

                            <td class="px-3">@user.DepartmentName</td>

                            <td class="px-3">@user.CompanyName</td>

                            <td class="px-3">@(@user.PositionName ?? "-")</td>

                            <td class="px-3">@(@user.ManagerName ?? "-")</td>

                            <td class="px-3 text-center">
                                @if (user.CanApprove)
                                {
                                    <span class="badge bg-success px-2">
                                        Lv @user.ApprovalLevel
                                    </span>
                                }
                                else
                                {
                                    <span class="badge bg-light text-muted border px-2">
                                        Yok
                                    </span>
                                }
                            </td>

                            <td class="px-3 text-center">
                                @if (user.IsActive && !user.IsDeleted)
                                {
                                    <span class="badge bg-success-subtle text-success border px-2">
                                        Aktif
                                    </span>
                                }
                                else
                                {
                                    <span class="badge bg-danger-subtle text-danger border px-2">
                                        Pasif
                                    </span>
                                }
                            </td>

                            <td class="px-3 text-end">
                                <div class="btn-group btn-group-sm shadow-sm" role="group">

                                    <a asp-controller="User"
                                       asp-action="Detail"
                                       asp-route-id="@user.Id"
                                       class="btn btn-light border"
                                       title="Görüntüle">
                                        <i class="bi bi-eye text-secondary"></i>
                                    </a>

                                    <a asp-controller="User"
                                       asp-action="Edit"
                                       asp-route-id="@user.Id"
                                       class="btn btn-light border"
                                       title="Düzenle">
                                        <i class="bi bi-pencil-square text-primary"></i>
                                    </a>

                                    <a asp-controller="User"
                                       asp-action="Delete"
                                       asp-route-id="@user.Id"
                                       class="btn btn-light border"
                                       title="Sil"
                                       onclick="return confirm('Bu kullanıcıyı silmek istiyor musunuz?')">
                                        <i class="bi bi-trash text-danger"></i>
                                    </a>

                                </div>
                            </td>
                        </tr>
                    }

                </tbody>
            </table>

        </div>
    </div>

</div>