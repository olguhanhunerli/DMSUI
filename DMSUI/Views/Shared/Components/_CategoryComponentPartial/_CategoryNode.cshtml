@using DMSUI.Entities.DTOs.Category
@model CategoryTreeDTO

@{
    var seciliId = Context.Request.Query["categoryId"].ToString();
    bool acikMi = seciliId == Model.Id.ToString();
}

<div class="accordion-item border-0 mb-1">

    <h2 class="accordion-header d-flex align-items-center gap-1 px-1 py-0">

        <button class="btn btn-sm btn-outline-secondary px-1 py-0 lh-1"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#kategori_@Model.Id"
                aria-expanded="@acikMi">
            <i class="bi bi-chevron-right" style="font-size:12px"></i>
        </button>

        <a asp-controller="Document"
           asp-action="Index"
           asp-route-categoryId="@Model.Id"
           class="fw-normal text-decoration-none text-dark d-flex align-items-center gap-1 px-1 py-0"
           style="font-size:13px">
            <i class="bi bi-folder" style="font-size:13px"></i>
            <span>@Model.Name</span>
        </a>

    </h2>

    <div id="kategori_@Model.Id"
         class="accordion-collapse collapse @(acikMi ? "show" : "")">

        <div class="accordion-body py-1 ps-3">

            @if (Model.Children != null && Model.Children.Any())
            {
                <ul class="list-unstyled mb-0">
                    @foreach (var altKategori in Model.Children)
                    {
                        <li class="py-0">

                            <a asp-controller="Document"
                               asp-action="Index"
                               asp-route-categoryId="@altKategori.Id"
                               class="text-decoration-none text-secondary d-flex align-items-center gap-1 px-1 py-0"
                               style="font-size:12px">
                                <i class="bi bi-folder2" style="font-size:12px"></i>
                                <span>@altKategori.Name</span>
                            </a>

                            @if (altKategori.Children != null && altKategori.Children.Any())
                            {
                                <div class="ps-3 mt-1 border-start">
                                    @await Html.PartialAsync(
                                             "~/Views/Shared/Components/_CategoryComponentPartial/_CategoryNode.cshtml",
                                             altKategori
                                             )
                                </div>
                            }

                        </li>
                    }
                </ul>
            }
            else
            {
                <span class="text-muted" style="font-size:11px">Alt kategori yok</span>
            }

        </div>
    </div>
</div>
